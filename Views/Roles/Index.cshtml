@model DSD603_BikeShopDB.Models.RolesIndexViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<div class="container mt-4">
	<h1>User & Role Management</h1>
	<!-- Action Buttons -->
	<div class="mb-4">
		<a asp-controller="Roles" asp-action="Create" class="btn btn-success">Create Role</a>
		<a asp-controller="Roles" asp-action="Assign" class="btn btn-primary">Assign Role</a>
	</div>
	<!-- All Roles List -->
	<section class="mt-5">
		<h2>All Roles</h2>
		@if (Model.Roles.Any())
		{
			<ul class="list-group">
				@foreach (var role in Model.Roles)
				{
					<li class="list-group-item d-flex justify-content-between align-items-center role-list">
						<span>
							<i class="bi bi-person-badge"></i> @role.Name
						</span>
						<span class="badge bg-primary rounded-pill">
							@Model.UserRoles.SelectMany(ur => ur.Roles).Count(r => r == role.Name)
						</span>
					</li>
				}
			</ul>
		}
		else
		{
			<div class="alert alert-info">
				<i class="bi bi-info-circle"></i> No roles have been created yet.
			</div>
		}
	</section>
	<!-- Users and Their Roles Table -->
	<section class="mt-5">
		<h2>Users and Their Roles</h2>
		@if (Model.UserRoles.Any())
		{
			<div class="table-responsive custom-table">
				<table class="table table-striped table-hover">
					<thead class="table-dark">
						<tr>
							<th>User Name</th>
							<th>Assigned Roles</th>
							<th>Role Count</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var ur in Model.UserRoles)
						{
							<tr>
								<td>
									<i class="bi bi-person"></i> @ur.UserName
								</td>
								<td>
									@if (ur.HasRoles)
									{
										@foreach (var role in ur.Roles)
										{
											<span class="badge bg-primary me-1">@role</span>
										}
									}
									else
									{
										<span class="text-muted">
											<i class="bi bi-dash"></i> No roles assigned
										</span>
									}
								</td>
								<td>
									<span class="badge bg-secondary">@ur.RoleCount</span>
								</td>
							</tr>
						}
					</tbody>
				</table>
			</div>
		}
		else
		{
			<div class="alert alert-info">
				<i class="bi bi-info-circle"></i> No users found in the system.
			</div>
		}
	</section>
</div>